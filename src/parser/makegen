#!/bin/sh

source_files=$(find . \
		      ! -name "tests.c" \
		      ! -name "repl.c" \
		        -name "*.c");
# remove newlines
source_files=$(echo $source_files | tr '\n' ' ');

# additional files generated by lex and yacc
# source_files=$(echo $source_files parser.tab.c lex.yy.c);

# take source files and replace their extensions to .o
# remove local path prefixes, because gcc puts them in the main folder
object_files=$(echo $source_files | sed -e "s/\.c/\.o/g" | xargs basename -a);

echo "source-files:=$source_files\n" "object-files:=$object_files" > Makefile ;
cat Makefile.in >> Makefile ;